<!--
Meta Description: # SASにおけるMERGEの使い方と活用法 ## 概要 SASの「MERGE」ステートメントは、複数のデータセットを結合するために使用されます。この機能により、異なるデータセットからの情報を一つのデータセットに統合し、データ分析や報告を容易にします。 ## ドキュメンテーション ### 目的 ME...
Meta Keywords: data, run, merge, sas, データセット1
-->

# SASにおけるMERGEの使い方と活用法

## 概要
SASの「MERGE」ステートメントは、複数のデータセットを結合するために使用されます。この機能により、異なるデータセットからの情報を一つのデータセットに統合し、データ分析や報告を容易にします。

## ドキュメンテーション
### 目的
MERGEステートメントの主な目的は、共通のキーを持つ複数のデータセットを結合することです。これは、データの整合性を保ちながら、情報を集約するために不可欠です。

### 使用法
MERGEを使用するには、以下の基本構文を使用します。

```sas
DATA 新しいデータセット名;
    MERGE データセット1 データセット2;
    BY キー変数;
RUN;
```

- **新しいデータセット名**: 結合後のデータセットの名前を指定します。
- **データセット1, データセット2**: 結合する元のデータセットを指定します。
- **キー変数**: データセットを結合する基準となる変数を指定します。この変数は全てのデータセットに存在し、同じ形式である必要があります。

### 詳細
- MERGEは、デフォルトで全ての行を結合しますが、キーが一致しない場合、結果のデータセットには欠損値が入ります。
- 複数のデータセットを結合する際は、必ずソートを行なう必要があります。これは、BYステートメントを使用するためです。
- 結合するデータセットの順序によって、出力結果が異なることがありますので注意が必要です。

## 例
### 例1: 基本的なMERGEの使用
```sas
DATA 合併データ;
    MERGE データセットA データセットB;
    BY ID;
RUN;
```

### 例2: 複数のデータセットの結合
```sas
DATA 最終データ;
    MERGE データセット1 データセット2 データセット3;
    BY 共通ID;
RUN;
```

### 例3: ソートとMERGE
```sas
PROC SORT DATA=データセットA;
    BY ID;
RUN;

PROC SORT DATA=データセットB;
    BY ID;
RUN;

DATA 結合データ;
    MERGE データセットA データセットB;
    BY ID;
RUN;
```

## 説明
MERGEを使用する際の一般的な落とし穴には、以下の点が含まれます。
- **ソートの必要性**: 事前にデータセットをソートしないと、正しい結合が行われません。
- **キーの不一致**: キー変数の形式や値が一致しない場合、正しい結合ができず、予期しない欠損値が発生します。
- **同名変数の扱い**: 結合するデータセットに同名の変数がある場合、最後に読み込まれたデータセットの値が優先されます。

## 一文要約
SASのMERGEステートメントは、共通のキーを使って複数のデータセットを結合し、情報を統合するための強力なツールです。